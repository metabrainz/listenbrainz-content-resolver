

                   WITH recording_ids AS (
                        SELECT DISTINCT(recording_id)
                          FROM tag
                          JOIN recording_tag
                            ON recording_tag.tag_id = tag.id
                          JOIN recording
                            ON recording.id = recording_tag.recording_id
                         WHERE name in ('hindi', '4ad')
                   )
                       SELECT recording_mbid
                            , popularity AS percent
                            , subsonic_id
                            , recording_name
                            , artist_name
                         FROM recording
                         JOIN recording_ids
                           ON recording.id = recording_ids.recording_id
                         JOIN recording_metadata
                           ON recording.id = recording_metadata.recording_id
                         JOIN recording_subsonic
                           ON recording.id = recording_subsonic.recording_id
                     ORDER BY popularity DESC
                         ;
